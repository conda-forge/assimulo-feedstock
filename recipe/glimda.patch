diff --git a/setup.py b/setup.py
index db510cb..93330de 100644
--- a/setup.py
+++ b/setup.py
@@ -629,10 +629,15 @@ class Assimulo_prepare(object):
         glimda_list = ['glimda_complete.f','glimda_complete.pyf']
         src=['assimulo'+os.sep+'thirdparty'+os.sep+'glimda'+os.sep+code for code in glimda_list]
         if self.with_BLAS and self.with_LAPACK:
-            extraargs_glimda={'extra_link_args':extra_link_flags[:], 'extra_compile_args':extra_compile_flags[:], 'library_dirs':[self.BLASdir, self.LAPACKdir], 'libraries':['lapack', self.BLASname]}
-            extraargs_glimda["extra_f77_compile_args"] = extra_fortran_compile_flags[:]
-            config.add_extension('assimulo.lib.glimda', sources= src,include_dirs=[np.get_include()],**extraargs_glimda) 
-            extra_link_flags=extra_link_flags[:-2]  # remove LAPACK flags after GLIMDA
+            #extraargs_glimda={'extra_link_args':extra_link_flags[:], 'extra_compile_args':extra_compile_flags[:], 'library_dirs':[self.BLASdir, self.LAPACKdir], 'libraries':['lapack', self.BLASname]}
+            #extraargs_glimda["extra_f77_compile_args"] = extra_fortran_compile_flags[:]
+            extra_link_flags_glimda = extra_link_flags[:]
+            extra_link_flags_glimda += ['-llapack', '-lblas']
+            config.add_extension('assimulo.lib.glimda',
+                                 sources= src,
+                                 include_dirs=[np.get_include()],extra_link_args=extra_link_flags_glimda[:],extra_f77_compile_args=extra_fortran_compile_flags[:], extra_compile_args=extra_compile_flags[:],extra_f90_compile_args=extra_fortran_compile_flags[:],
+                                 library_dirs=[self.BLASdir, self.LAPACKdir], libraries=['lapack', self.BLASname])
+            #extra_link_flags=extra_link_flags[:-2]  # remove LAPACK flags after GLIMDA
         elif self.with_MKL: #assuming windows and Intel fortran compiler
             config.add_extension('assimulo.lib.glimda', sources= src,include_dirs=[np.get_include()], library_dirs=[self.MKLdir], libraries=[self.MKLname])
         else:
